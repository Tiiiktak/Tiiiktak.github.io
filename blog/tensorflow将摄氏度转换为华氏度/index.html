<!DOCTYPE html>
<html lang="cn">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='ä»Šå¤©å¼€å§‹åœ¨çœ‹Udacityä¸Šçš„TensorFlowå…¥é—¨è¯¾ç¨‹ï¼Œå…¶ä¸­æ„å»ºçš„ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹å°±æ˜¯å°†æ‘„æ°åº¦è½¬æ¢æˆåæ°åº¦ï¼Œäºæ˜¯åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹
å…¬å¼ å·²çŸ¥æ‘„æ°åº¦è½¬æ¢æˆåæ°åº¦æœ‰æ•°å­¦å…¬å¼ï¼š
f = c * 1.8 &#43; 32 è€Œæˆ‘ä»¬å°±è¦åœ¨ä¸å‘ŠçŸ¥æ¨¡å‹è¿™ä¸ªå…¬å¼çš„å‰æä¸‹ï¼Œé€šè¿‡å‘ŠçŸ¥ä¸€ç³»åˆ—å¯¹åº”çš„æ‘„æ°åº¦ä¸åæ°åº¦æ ·ä¾‹ï¼Œæ¥è®­ç»ƒå®ƒä»¥å®ç°æ‘„æ°åº¦è½¬åæ°åº¦è¿™ä¸€åŠŸèƒ½
import dependencies å¯¼å…¥ä¾èµ–é¡¹ éœ€è¦å¼•å…¥TensorFlowä¸NumPyåº“æ„å»ºç¥ç»ç½‘ç»œ
from __future__ import absolute_import, division, print_function, unicode_literals import tensorflow as tf import numpy as np è¿˜éœ€è¦å¼•å…¥loggingä»¥è®°å½•æ—¥å¿—
import logging logger = tf.get_logger() #è¿”å›tfçš„æ—¥å¿—å®ä¾‹ logger.setLevel(logging.ERROR) Set up training data å»ºç«‹è®­ç»ƒæ•°æ® ç”±äºåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ç›‘ç£å¼æœºå™¨å­¦ä¹ ï¼Œæ‰€ä»¥å‡†å¤‡ä¸¤ç»„é“¾è¡¨celsius_qå’Œfahrenheit_aåˆ†åˆ«ä»£è¡¨æ‘„æ°æ¸©åº¦ä¸å¯¹åº”åæ°æ¸©åº¦ï¼Œç”¨æ¥è®­ç»ƒæ¨¡å‹
celsius_q = np.array([-40, -10, 0, 8, 15, 22, 38], dtype=float) fahrenheit_a = np.array([-40, 14, 32, 46, 59, 72, 100], dtype=float) for i,c in enumerate(celsius_q): print(&amp;#34;{} degrees Celsius = {} degrees Fahrenheit&amp;#34;.'><title>ç¬¬ä¸€ä¸ªTensorFlowæ¨¡å‹ï¼šæ‘„æ°åº¦è½¬æ¢ä¸ºåæ°åº¦</title>

<link rel='canonical' href='https://konosuba.xyz/blog/tensorflow%E5%B0%86%E6%91%84%E6%B0%8F%E5%BA%A6%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%8D%8E%E6%B0%8F%E5%BA%A6/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='ç¬¬ä¸€ä¸ªTensorFlowæ¨¡å‹ï¼šæ‘„æ°åº¦è½¬æ¢ä¸ºåæ°åº¦'>
<meta property='og:description' content='ä»Šå¤©å¼€å§‹åœ¨çœ‹Udacityä¸Šçš„TensorFlowå…¥é—¨è¯¾ç¨‹ï¼Œå…¶ä¸­æ„å»ºçš„ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹å°±æ˜¯å°†æ‘„æ°åº¦è½¬æ¢æˆåæ°åº¦ï¼Œäºæ˜¯åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹
å…¬å¼ å·²çŸ¥æ‘„æ°åº¦è½¬æ¢æˆåæ°åº¦æœ‰æ•°å­¦å…¬å¼ï¼š
f = c * 1.8 &#43; 32 è€Œæˆ‘ä»¬å°±è¦åœ¨ä¸å‘ŠçŸ¥æ¨¡å‹è¿™ä¸ªå…¬å¼çš„å‰æä¸‹ï¼Œé€šè¿‡å‘ŠçŸ¥ä¸€ç³»åˆ—å¯¹åº”çš„æ‘„æ°åº¦ä¸åæ°åº¦æ ·ä¾‹ï¼Œæ¥è®­ç»ƒå®ƒä»¥å®ç°æ‘„æ°åº¦è½¬åæ°åº¦è¿™ä¸€åŠŸèƒ½
import dependencies å¯¼å…¥ä¾èµ–é¡¹ éœ€è¦å¼•å…¥TensorFlowä¸NumPyåº“æ„å»ºç¥ç»ç½‘ç»œ
from __future__ import absolute_import, division, print_function, unicode_literals import tensorflow as tf import numpy as np è¿˜éœ€è¦å¼•å…¥loggingä»¥è®°å½•æ—¥å¿—
import logging logger = tf.get_logger() #è¿”å›tfçš„æ—¥å¿—å®ä¾‹ logger.setLevel(logging.ERROR) Set up training data å»ºç«‹è®­ç»ƒæ•°æ® ç”±äºåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ç›‘ç£å¼æœºå™¨å­¦ä¹ ï¼Œæ‰€ä»¥å‡†å¤‡ä¸¤ç»„é“¾è¡¨celsius_qå’Œfahrenheit_aåˆ†åˆ«ä»£è¡¨æ‘„æ°æ¸©åº¦ä¸å¯¹åº”åæ°æ¸©åº¦ï¼Œç”¨æ¥è®­ç»ƒæ¨¡å‹
celsius_q = np.array([-40, -10, 0, 8, 15, 22, 38], dtype=float) fahrenheit_a = np.array([-40, 14, 32, 46, 59, 72, 100], dtype=float) for i,c in enumerate(celsius_q): print(&amp;#34;{} degrees Celsius = {} degrees Fahrenheit&amp;#34;.'>
<meta property='og:url' content='https://konosuba.xyz/blog/tensorflow%E5%B0%86%E6%91%84%E6%B0%8F%E5%BA%A6%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%8D%8E%E6%B0%8F%E5%BA%A6/'>
<meta property='og:site_name' content='Tiiktak&#39;s'>
<meta property='og:type' content='article'><meta property='article:section' content='Blog' /><meta property='article:published_time' content='2019-10-11T20:33:51&#43;08:00'/><meta property='article:modified_time' content='2019-10-11T20:33:51&#43;08:00'/>
<meta name="twitter:title" content="ç¬¬ä¸€ä¸ªTensorFlowæ¨¡å‹ï¼šæ‘„æ°åº¦è½¬æ¢ä¸ºåæ°åº¦">
<meta name="twitter:description" content="ä»Šå¤©å¼€å§‹åœ¨çœ‹Udacityä¸Šçš„TensorFlowå…¥é—¨è¯¾ç¨‹ï¼Œå…¶ä¸­æ„å»ºçš„ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹å°±æ˜¯å°†æ‘„æ°åº¦è½¬æ¢æˆåæ°åº¦ï¼Œäºæ˜¯åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹
å…¬å¼ å·²çŸ¥æ‘„æ°åº¦è½¬æ¢æˆåæ°åº¦æœ‰æ•°å­¦å…¬å¼ï¼š
f = c * 1.8 &#43; 32 è€Œæˆ‘ä»¬å°±è¦åœ¨ä¸å‘ŠçŸ¥æ¨¡å‹è¿™ä¸ªå…¬å¼çš„å‰æä¸‹ï¼Œé€šè¿‡å‘ŠçŸ¥ä¸€ç³»åˆ—å¯¹åº”çš„æ‘„æ°åº¦ä¸åæ°åº¦æ ·ä¾‹ï¼Œæ¥è®­ç»ƒå®ƒä»¥å®ç°æ‘„æ°åº¦è½¬åæ°åº¦è¿™ä¸€åŠŸèƒ½
import dependencies å¯¼å…¥ä¾èµ–é¡¹ éœ€è¦å¼•å…¥TensorFlowä¸NumPyåº“æ„å»ºç¥ç»ç½‘ç»œ
from __future__ import absolute_import, division, print_function, unicode_literals import tensorflow as tf import numpy as np è¿˜éœ€è¦å¼•å…¥loggingä»¥è®°å½•æ—¥å¿—
import logging logger = tf.get_logger() #è¿”å›tfçš„æ—¥å¿—å®ä¾‹ logger.setLevel(logging.ERROR) Set up training data å»ºç«‹è®­ç»ƒæ•°æ® ç”±äºåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ç›‘ç£å¼æœºå™¨å­¦ä¹ ï¼Œæ‰€ä»¥å‡†å¤‡ä¸¤ç»„é“¾è¡¨celsius_qå’Œfahrenheit_aåˆ†åˆ«ä»£è¡¨æ‘„æ°æ¸©åº¦ä¸å¯¹åº”åæ°æ¸©åº¦ï¼Œç”¨æ¥è®­ç»ƒæ¨¡å‹
celsius_q = np.array([-40, -10, 0, 8, 15, 22, 38], dtype=float) fahrenheit_a = np.array([-40, 14, 32, 46, 59, 72, 100], dtype=float) for i,c in enumerate(celsius_q): print(&amp;#34;{} degrees Celsius = {} degrees Fahrenheit&amp;#34;."><style>
    :root {
        --article-font-family: "Noto Serif SC", var(--base-font-family);
    }
</style>

<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "<https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap>";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
    </head>
    <body class="article-page keep-sidebar">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column extended ">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu1d1fe176dd879a425067b8d2a78bfc4d_5239_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸˆ</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://konosuba.xyz">Tiiktak&#39;s</a></h1>
        <h2 class="site-description">æ¯å½“å¿ƒæƒ…éƒé—·çš„æ—¶å€™ï¼Œç”¨æ‰‹æ‰˜è…®å°±å¥½ï¼Œæ‰‹è‡‚ä¼šå› ä¸ºå¸®ä¸Šå¿™è€Œå¼€å¿ƒçš„ã€‚</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>æš—è‰²æ¨¡å¼</span>
            </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="background-color: #2a9d8f; color: #fff;">
                æ·±åº¦å­¦ä¹ 
            </a>
        
            <a href="/categories/tensorflow/" style="background-color: #2a9d8f; color: #fff;">
                TensoFlow
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/blog/tensorflow%E5%B0%86%E6%91%84%E6%B0%8F%E5%BA%A6%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%8D%8E%E6%B0%8F%E5%BA%A6/">ç¬¬ä¸€ä¸ªTensorFlowæ¨¡å‹ï¼šæ‘„æ°åº¦è½¬æ¢ä¸ºåæ°åº¦</a>
    </h2>

    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">Oct 11, 2019</time>
    </footer></div>
</header>

    <section class="article-content">
    <p>ä»Šå¤©å¼€å§‹åœ¨çœ‹Udacityä¸Šçš„TensorFlowå…¥é—¨è¯¾ç¨‹ï¼Œå…¶ä¸­æ„å»ºçš„ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹å°±æ˜¯å°†æ‘„æ°åº¦è½¬æ¢æˆåæ°åº¦ï¼Œäºæ˜¯åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹</p>
<h2 id="å…¬å¼">å…¬å¼</h2>
<p>å·²çŸ¥æ‘„æ°åº¦è½¬æ¢æˆåæ°åº¦æœ‰æ•°å­¦å…¬å¼ï¼š</p>
<pre><code>f = c * 1.8 + 32
</code></pre><p>è€Œæˆ‘ä»¬å°±è¦åœ¨ä¸å‘ŠçŸ¥æ¨¡å‹è¿™ä¸ªå…¬å¼çš„å‰æä¸‹ï¼Œé€šè¿‡å‘ŠçŸ¥ä¸€ç³»åˆ—å¯¹åº”çš„æ‘„æ°åº¦ä¸åæ°åº¦æ ·ä¾‹ï¼Œæ¥è®­ç»ƒå®ƒä»¥å®ç°æ‘„æ°åº¦è½¬åæ°åº¦è¿™ä¸€åŠŸèƒ½</p>
<h2 id="import-dependencies-å¯¼å…¥ä¾èµ–é¡¹">import dependencies å¯¼å…¥ä¾èµ–é¡¹</h2>
<p>éœ€è¦å¼•å…¥<code>TensorFlow</code>ä¸<code>NumPy</code>åº“æ„å»ºç¥ç»ç½‘ç»œ</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</code></pre></div><p>è¿˜éœ€è¦å¼•å…¥<code>logging</code>ä»¥è®°å½•æ—¥å¿—</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span> <span class="c1">#è¿”å›tfçš„æ—¥å¿—å®ä¾‹</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
</code></pre></div><h2 id="set-up-training-data-å»ºç«‹è®­ç»ƒæ•°æ®">Set up training data å»ºç«‹è®­ç»ƒæ•°æ®</h2>
<p>ç”±äºåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ç›‘ç£å¼æœºå™¨å­¦ä¹ ï¼Œæ‰€ä»¥å‡†å¤‡ä¸¤ç»„é“¾è¡¨<code>celsius_q</code>å’Œ<code>fahrenheit_a</code>åˆ†åˆ«ä»£è¡¨æ‘„æ°æ¸©åº¦ä¸å¯¹åº”åæ°æ¸©åº¦ï¼Œç”¨æ¥è®­ç»ƒæ¨¡å‹</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="n">celsius_q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">38</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">fahrenheit_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">celsius_q</span><span class="p">):</span>
  <span class="k">print</span><span class="p">(</span><span class="s2">&#34;{} degrees Celsius = {} degrees Fahrenheit&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">fahrenheit_a</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</code></pre></div><p>è¾“å‡ºï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="o">-</span><span class="mf">40.0</span> <span class="n">degrees</span> <span class="n">Celsius</span> <span class="o">=</span> <span class="o">-</span><span class="mf">40.0</span> <span class="n">degrees</span> <span class="n">Fahrenheit</span>
<span class="o">-</span><span class="mf">10.0</span> <span class="n">degrees</span> <span class="n">Celsius</span> <span class="o">=</span> <span class="mf">14.0</span> <span class="n">degrees</span> <span class="n">Fahrenheit</span>
<span class="mf">0.0</span> <span class="n">degrees</span> <span class="n">Celsius</span> <span class="o">=</span> <span class="mf">32.0</span> <span class="n">degrees</span> <span class="n">Fahrenheit</span>
<span class="mf">8.0</span> <span class="n">degrees</span> <span class="n">Celsius</span> <span class="o">=</span> <span class="mf">46.0</span> <span class="n">degrees</span> <span class="n">Fahrenheit</span>
<span class="mf">15.0</span> <span class="n">degrees</span> <span class="n">Celsius</span> <span class="o">=</span> <span class="mf">59.0</span> <span class="n">degrees</span> <span class="n">Fahrenheit</span>
<span class="mf">22.0</span> <span class="n">degrees</span> <span class="n">Celsius</span> <span class="o">=</span> <span class="mf">72.0</span> <span class="n">degrees</span> <span class="n">Fahrenheit</span>
<span class="mf">38.0</span> <span class="n">degrees</span> <span class="n">Celsius</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="n">degrees</span> <span class="n">Fahrenheit</span>
</code></pre></div><h3 id="ä¸€äº›æœºå™¨å­¦ä¹ æœ¯è¯­">ä¸€äº›æœºå™¨å­¦ä¹ æœ¯è¯­ï¼š</h3>
<ul>
<li>Featureï¼ˆç‰¹å¾ï¼‰ï¼šæ¨¡å‹çš„è¾“å…¥ã€‚åœ¨è¿™é‡Œå³æ‘„æ°åº¦</li>
<li>Labelsï¼ˆæ ‡ç­¾ï¼‰ï¼šæ¨¡å‹çš„è¾“å‡ºã€‚åœ¨è¿™é‡Œå³åæ°åº¦</li>
<li>Exampleï¼ˆæ ·æœ¬ï¼‰ï¼šè®­ç»ƒæœŸé—´æ•°æ®é›†çš„ä¸€è¡Œå†…å®¹ï¼Œå¯ä»¥æ˜¯æ ‡æ³¨æ ·æœ¬(labeled example)å’Œæ— æ ‡æ³¨æ ·æœ¬(unlabeled example)ã€‚åœ¨è¿™é‡Œå³ä¸€å¯¹æ‘„æ°åº¦ä¸åæ°åº¦æ•°æ®ï¼Œä¸ºæ ‡æ³¨æ ·æœ¬</li>
</ul>
<h2 id="create-the-model-åˆ›å»ºæ¨¡å‹">Create the model åˆ›å»ºæ¨¡å‹</h2>
<p>ç”±äºé—®é¢˜æ¯”è¾ƒç®€å•ï¼Œå› æ­¤æˆ‘ä»¬è¦å»ºç«‹çš„å¯†é›†ç½‘ç»œå°†åªéœ€è¦ä¸€ä¸ªå•å±‚ç¥ç»å…ƒ</p>
<h3 id="build-a-layer-å»ºç«‹ä¸€ä¸ªå±‚">Build a layer å»ºç«‹ä¸€ä¸ªå±‚</h3>
<p>æˆ‘ä»¬ä¼šæŠŠè¿™ä¸€å±‚å«åš<code>l0</code>ï¼Œå¹¶ä¸”ä½¿ç”¨<code> tf.keras.layers.Dense</code>(å…¨è¿æ¥å±‚)æ¥å»ºç«‹</p>
<h4 id="tfkeraslayersdense"><code>tf.keras.layers.Dense</code></h4>
<ul>
<li>
<p><code>units=1</code> æŒ‡å®šæœ¬å±‚ç¥ç»å…ƒæ•°é‡ã€‚ç¥ç»å…ƒçš„æ•°é‡å®šä¹‰äº†æœ¬å±‚éœ€è¦æœ‰å¤šå°‘å†…éƒ¨å˜é‡æ¥å­¦ä¹ è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç”±äºè¿™æ˜¯æœ¬æ¨¡å‹çš„æœ€åä¸€å±‚ï¼Œå› æ­¤å®ƒä¹Ÿä»£è¡¨æ¨¡å‹è¾“å‡ºçš„å¤§å°ã€‚ï¼ˆåœ¨å¤šå±‚ç¥ç»ç½‘ç»œä¸­ï¼Œè¯¥å±‚çš„å¤§å°ä¸å½¢çŠ¶éœ€è¦ä¸ä¸‹ä¸€å±‚çš„<code>input_shape</code>ç›¸åŒ¹é…</p>
</li>
<li>
<p><code>input_shape=[1]</code> æŒ‡å®šæœ¬å±‚è¾“å…¥å€¼ä¸ºå•å€¼ã€‚è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªåŒ…å«å•ä¸ªæˆå‘˜çš„ä¸€ç»´æ•°ç»„ã€‚ç”±äºè¿™æ˜¯æœ¬æ¨¡å‹çš„ç¬¬ä¸€å±‚ï¼ˆä¹Ÿæ˜¯å”¯ä¸€ä¸€å±‚ï¼‰ï¼Œå› æ­¤è¯¥è¾“å…¥å½¢çŠ¶ä¹Ÿæ˜¯æ•´ä¸ªæ¨¡å‹çš„è¾“å…¥å½¢çŠ¶ã€‚å•å€¼æ˜¯æµ®ç‚¹æ•°ï¼Œå³æ‘„æ°åº¦</p>
</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="n">l0</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div><h3 id="assemble-layers-into-the-model-å°†layerç»„è£…åˆ°æ¨¡å‹ä¸­">Assemble layers into the model å°†Layerç»„è£…åˆ°æ¨¡å‹ä¸­</h3>
<p>å®šä¹‰äº†å±‚ä¹‹åï¼Œå°±è¦å°†å®ƒä»¬ç»„è£…æˆæ¨¡å‹ã€‚Sequential model é¡ºåºæ¨¡å‹çš„å®šä¹‰éœ€è¦ä»¥å±‚åˆ—è¡¨ä½œä¸ºå‚æ•°ï¼ŒæŒ‡å®šä»è¾“å…¥åˆ°è¾“å‡ºçš„è®¡ç®—é¡ºåº</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">l0</span><span class="p">])</span>
</code></pre></div><blockquote>
<p>æ³¨æ„ï¼š
ä»¥ä¸Šä¸¤æ­¥ç»å¸¸åˆå¹¶ä¸ºä¸€æ­¥æ“ä½œï¼Œå¦‚</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">])</span>
</code></pre></div><h2 id="compile-the-model-with-loss-and-optimizer-functions-ä½¿ç”¨æŸå¤±å’Œä¼˜åŒ–å™¨åŠŸèƒ½ç¼–è¯‘æ¨¡å‹">Compile the model, with loss and optimizer functions ä½¿ç”¨æŸå¤±å’Œä¼˜åŒ–å™¨åŠŸèƒ½ç¼–è¯‘æ¨¡å‹</h2>
<p>æ­å¥½æ¨¡å‹æ¶æ„ä¹‹åï¼Œåœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰ï¼Œè¿˜è¦æ‰§è¡Œç¼–è¯‘æ“ä½œã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œç»å¸¸éœ€è¦æŒ‡å®šä¸‰ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>
<p><code>Loss function</code> ä¸€ç§è¡¡é‡ç»“æœä¸é¢„æœŸç›¸å·®å¤šå°‘çš„æ–¹æ³•ï¼ˆæµ‹å¾—çš„å·®å¼‚ç§°ä¸º<code>loss</code>(æŸå¤±)ï¼‰</p>
</li>
<li>
<p><code>Optimizer function</code> ä¸€ç§è°ƒæ•´å†…éƒ¨å€¼ä»¥å‡å°‘æŸè€—çš„æ–¹æ³•</p>
</li>
<li>
<p><code>Metrics function</code> ï¼ˆè¾ƒå¤æ‚ï¼Œæ­¤å¤„ä¸ç”¨ï¼Œæ—¥åå†çœ‹ï¼‰</p>
</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-py3" data-lang="py3"><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
</code></pre></div><p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨<code>model.fit()</code>æ¥é¦–å…ˆè®¡ç®—æ¯ä¸ªç‚¹çš„æŸè€—ï¼Œä¹‹åå¯¹å…¶æ”¹å–„ã€‚ä¼˜åŒ–å™¨åŠŸèƒ½ç”¨äºè®¡ç®—å¯¹æ¨¡å‹å†…éƒ¨å˜é‡çš„è°ƒæ•´ï¼Œç›®çš„æ˜¯è°ƒæ•´å†…éƒ¨å˜é‡ç›´åˆ°æ¨¡å‹ï¼ˆå®é™…æ˜¯ä¸€ä¸ªæ•°å­¦å‡½æ•°ï¼‰æ¥è¿‘å°†æ‘„æ°åº¦è½¬æ¢ä¸ºåæ°åº¦çš„å…¬å¼ä¸ºæ­¢</p>
<p>è¿™é‡Œä½¿ç”¨çš„ä¼˜åŒ–å‡½æ•°<code>mean_squared_error</code>ï¼ˆå‡æ–¹è¯¯å·®ï¼‰å’Œä¼˜åŒ–å™¨<code>Adam</code>æ˜¯è¿™ç§ç®€å•æ¨¡å‹çš„æ ‡å‡†é…ç½®ï¼Œå®é™…è¿˜æœ‰å…¶ä»–å¯ç”¨é…ç½®ã€‚</p>
<p>åœ¨å»ºç«‹è‡ªå·±çš„æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çš„<code>Optimizer</code>ä¼˜åŒ–å™¨çš„éƒ¨åˆ†æ˜¯å­¦ä¹ ç‡ï¼ˆå³ä¸Šå¼ä¸­çš„0.1ï¼‰ï¼Œè¿™æ˜¯åœ¨æ¨¡å‹ä¸­è°ƒæ•´å€¼æ—¶é‡‡å–çš„æ­¥é•¿ï¼Œå®ƒå†³å®šç€ç›®æ ‡å‡½æ•°èƒ½å¦æ”¶æ•›åˆ°å±€éƒ¨æœ€å°å€¼ä»¥åŠä½•æ—¶æ”¶æ•›åˆ°æœ€å°å€¼ã€‚åˆé€‚çš„å­¦ä¹ ç‡èƒ½å¤Ÿä½¿ç›®æ ‡å‡½æ•°åœ¨åˆé€‚çš„æ—¶é—´å†…æ”¶æ•›åˆ°å±€éƒ¨æœ€å°å€¼ã€‚èŒƒå›´é€šå¸¸åœ¨0.001ï¼ˆé»˜è®¤ï¼‰å’Œ0.1ä¹‹é—´</p>
<h2 id="train-the-model-è®­ç»ƒæ¨¡å‹">Train the model è®­ç»ƒæ¨¡å‹</h2>
<p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹è¾“å…¥æ‘„æ°æ¸©åº¦ï¼Œä½¿ç”¨å½“å‰çš„å†…éƒ¨å˜é‡ï¼ˆæƒé‡ï¼‰æ‰§è¡Œè®¡ç®—ï¼Œå¹¶è¾“å‡ºç›¸åº”åæ°æ¸©åº¦çš„å€¼ã€‚ ç”±äºæƒé‡æœ€åˆæ˜¯éšæœºè®¾ç½®çš„ï¼Œå› æ­¤è¾“å‡ºå¹¶ä¸ä¼šæ¥è¿‘æ­£ç¡®çš„å€¼ã€‚å®é™…è¾“å‡ºä¸æœŸæœ›è¾“å‡ºä¹‹é—´çš„å·®å€¼é€šè¿‡æŸå¤±å‡½æ•°è®¡ç®—ï¼Œè€Œä¼˜åŒ–å™¨å‡½æ•°å°†æŒ‡å¯¼å¦‚ä½•è°ƒæ•´æƒé‡ã€‚</p>
<p>è®¡ç®—ï¼Œæ¯”è¾ƒï¼Œè°ƒæ•´çš„æ•´ä¸ªæµç¨‹ç”±<code>fit</code>æ–¹æ³•è¿›è¡Œæ§åˆ¶ã€‚ å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¾“å…¥ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æœŸæœ›çš„è¾“å‡ºç»“æœã€‚<code>epochs</code>å‚æ•°æŒ‡å®šæ¨¡å‹åº”è¿è¡Œæ­¤å¾ªç¯å¤šå°‘æ¬¡ï¼Œè€Œ<code>verbose</code>å‚æ•°æ§åˆ¶è¯¥æ–¹æ³•çš„æ—¥å¿—æ˜¾ç¤ºã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">celsius_q</span><span class="p">,</span> <span class="n">fahrenheit_a</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c1">#fitæ–¹æ³•è¿”å›Historyå¯¹è±¡</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;Finished training the model&#34;</span><span class="p">)</span>
</code></pre></div><p>è¾“å‡ºï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="n">Finished</span> <span class="n">training</span> <span class="n">the</span> <span class="n">model</span>
</code></pre></div><blockquote>
<p><strong>verboseå‚æ•°</strong></p>
</blockquote>
<blockquote>
<ul>
<li>é»˜è®¤ä¸º1</li>
<li>verbose = 0 ä¸ºä¸åœ¨æ ‡å‡†è¾“å‡ºæµè¾“å‡ºæ—¥å¿—ä¿¡æ¯</li>
<li>verbose = 1 ä¸ºè¾“å‡ºè¿›åº¦æ¡è®°å½•</li>
<li>verbose = 2 ä¸ºæ¯ä¸ªepochè¾“å‡ºä¸€è¡Œè®°å½•</li>
</ul>
</blockquote>
<blockquote>
<p><strong>Historyå¯¹è±¡</strong></p>
</blockquote>
<blockquote>
<p>å¯ä»¥ç”±fit()æ–¹æ³•è¿”å›ã€‚History.historyå±æ€§æ˜¯ä¸€ä¸ªè®°å½•äº†è¿ç»­è¿­ä»£çš„è®­ç»ƒ/éªŒè¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰æŸå¤±å€¼å’Œè¯„ä¼°å€¼çš„å­—å…¸ã€‚å¯ä»¥åˆ©ç”¨è¯¥å¯¹è±¡å®ç°<a class="link" href="https://keras.io/zh/visualization/#_2"  target="_blank" rel="noopener"
    >è®­ç»ƒå†å²å¯è§†åŒ–</a></p>
</blockquote>
<h2 id="display-training-statistics-å±•ç¤ºè®­ç»ƒç»Ÿè®¡æ•°æ®">Display training statistics å±•ç¤ºè®­ç»ƒç»Ÿè®¡æ•°æ®</h2>
<p>ç”±äº<code>fit</code>ä¼šè¿”å›ä¸€ä¸ª<code>History</code>å¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥å¯¹è±¡æ¥ç»˜åˆ¶æ¯ä¸ªè®­ç»ƒæ—¶æœŸåæ¨¡å‹æŸå¤±çš„ä¸‹é™è¶‹åŠ¿ã€‚è‹¥ä¸ºé«˜æŸè€—åˆ™æ„å‘³ç€æ¨¡å‹é¢„æµ‹çš„åæ°åº¦ä¸<code>fahrenheit_a</code>ä¸­çš„æœŸæœ›å€¼ç›¸å»ç”šè¿œã€‚</p>
<p>ä½¿ç”¨<code>Matplotlib</code>è¿›è¡Œç»˜åˆ¶</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epoch Number&#39;</span><span class="p">)</span> <span class="c1">#xåæ ‡è½´</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&#34;Loss Magnitude&#34;</span><span class="p">)</span> <span class="c1">#yåæ ‡è½´</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">])</span> <span class="c1">#æ ‡ç‚¹</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p>ç»“æœï¼š</p>
<p><img src="https://i.loli.net/2019/09/25/eAJP7K4LB2uzRUl.png" alt="æ‘„æ°åº¦è½¬åæ°åº¦æ¨¡å‹æŸå¤±ç»Ÿè®¡"  /></p>
<p>å¯è§ï¼Œæˆ‘ä»¬çš„æ¨¡å‹èµ·åˆæ”¹è¿›éå¸¸å¿«ï¼Œç„¶åæœ‰äº†ç¨³å®šè€Œç¼“æ…¢çš„æ”¹è¿›ï¼Œç›´åˆ°æœ€ç»ˆæ¥è¿‘â€œå®Œç¾â€ä¸ºæ­¢ã€‚</p>
<h2 id="use-the-model-to-predict-values-ä½¿ç”¨æ¨¡å‹é¢„æµ‹æ•°å€¼">Use the model to predict values ä½¿ç”¨æ¨¡å‹é¢„æµ‹æ•°å€¼</h2>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æ‹¥æœ‰äº†ä¸€ä¸ªå¯ä»¥åˆ©ç”¨æ‘„æ°åº¦è·å¾—åæ°åº¦çš„æ¨¡å‹ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒè®¡ç®—å…ˆå‰æœªçŸ¥çš„æ‘„æ°æ¸©åº¦</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="mf">100.0</span><span class="p">]))</span> <span class="c1">#å‘æ¨¡å‹è¾“å…¥100.0</span>
</code></pre></div><p>è¾“å‡ºï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="p">[[</span><span class="mf">211.74744</span><span class="p">]]</span>
</code></pre></div><p>è€Œæˆ‘ä»¬é€šè¿‡å…¬å¼å¯ä»¥å¾—åˆ°ï¼š</p>
<pre><code>100*1.8 + 32 = 212
</code></pre><p>ç”±æ­¤å¯è§ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å¾—åˆ°çš„ç»“æœå·²ç»éå¸¸æ¥è¿‘çœŸå®ç­”æ¡ˆ</p>
<h2 id="to-review-å›é¡¾">To review å›é¡¾</h2>
<ol>
<li>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå«æœ‰å•å±‚ç¥ç»å…ƒçš„æ¨¡å‹</li>
<li>å°†æ¨¡å‹è®­ç»ƒäº†3500æ¬¡ï¼ˆ7å¯¹æ•°æ®ï¼Œ500è½®ï¼‰</li>
</ol>
<p>æˆ‘ä»¬çš„æ¨¡å‹è°ƒæ•´äº†Denseå±‚ä¸­çš„å˜é‡ï¼ˆæƒé‡ï¼‰ï¼Œç›´åˆ°å®ƒèƒ½å¤Ÿä¸ºä»»ä½•æ‘„æ°å€¼è¿”å›æ­£ç¡®çš„åæ°æ¸©åº¦å€¼</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="n">l0</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">l0</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">celsius_q</span><span class="p">,</span> <span class="n">fahrenheit_a</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="mf">100.0</span><span class="p">])</span>
</code></pre></div><h2 id="looking-at-the-layer-weights-æŸ¥çœ‹layeræƒé‡">Looking at the layer weights æŸ¥çœ‹Layeræƒé‡</h2>
<p>æœ€åæˆ‘ä»¬æ‰“å°Denseå±‚çš„å†…éƒ¨å˜é‡</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="k">print</span><span class="p">(</span><span class="s2">&#34;These are the layer variables: {}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l0</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()))</span> <span class="c1">#ä»¥åŒ…å«NumpyçŸ©é˜µçš„åˆ—è¡¨å½¢å¼è¿”å›å±‚çš„æƒé‡</span>
</code></pre></div><p>è¾“å‡ºï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="n">These</span> <span class="n">are</span> <span class="n">the</span> <span class="n">layer</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.7979496</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">),</span> <span class="n">array</span><span class="p">([</span><span class="mf">31.952478</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)]</span>
</code></pre></div><p>è¿™é‡Œçš„ç¬¬ä¸€ä¸ªå˜é‡<code>1.7979496</code>æ¥è¿‘äº<code>1.8</code>ï¼Œç¬¬äºŒä¸ªå˜é‡<code>31.952478</code>æ¥è¿‘äº<code>32</code>ï¼Œè€Œè¿™ä¸¤ä¸ªå€¼ä¹Ÿæ˜¯å®é™…çš„è½¬æ¢å…¬å¼ä¸­çš„ä¸¤ä¸ªå˜é‡</p>
<p>å¯¹äºåªæœ‰å•ä¸ªè¾“å…¥å’Œå•ä¸ªè¾“å‡ºçš„å•ç¥ç»å…ƒï¼Œå®ƒå†…éƒ¨çœ‹èµ·æ¥ä¸ç›´çº¿æ–¹ç¨‹ç›¸åŒï¼Œå³y=mx+bï¼Œå› æ­¤æˆ‘ä»¬çš„æ¨¡å‹èƒ½å¤Ÿå¦‚æ­¤é€¼è¿‘è½¬æ¢å…¬å¼</p>
<p>è€Œæœ‰äº†é¢å¤–çš„ç¥ç»å…ƒï¼Œé¢å¤–çš„è¾“å…¥å’Œé¢å¤–çš„è¾“å‡ºï¼Œå…¬å¼ä¼šå˜å¾—æ›´åŠ å¤æ‚ï¼Œä½†æ˜¯æ€è·¯æ˜¯ä¸€æ ·çš„ã€‚</p>
<h3 id="a-little-experiment-å°å®éªŒ">A little experiment å°å®éªŒ</h3>
<p>å¦‚æœæˆ‘ä»¬åˆ›å»ºå¤šä¸ªå«ä¸åŒæ•°é‡ç¥ç»å…ƒçš„å±‚ï¼Œä¼šæ˜¯æ€æ ·çš„ç»“æœå‘¢ï¼Ÿ</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="n">l0</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">l1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">l2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">l0</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">celsius_q</span><span class="p">,</span> <span class="n">fahrenheit_a</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;Finished training the model&#34;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;Model predicts that 100 degrees Celsius is: {} degrees Fahrenheit&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="mf">100.0</span><span class="p">])))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;These are the l0 variables: {}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l0</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;These are the l1 variables: {}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l1</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;These are the l2 variables: {}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()))</span>
</code></pre></div><p>è¾“å‡ºï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-py" data-lang="py"><span class="n">Finished</span> <span class="n">training</span> <span class="n">the</span> <span class="n">model</span>
<span class="n">Model</span> <span class="n">predicts</span> <span class="n">that</span> <span class="mi">100</span> <span class="n">degrees</span> <span class="n">Celsius</span> <span class="ow">is</span><span class="p">:</span> <span class="p">[[</span><span class="mf">211.74742</span><span class="p">]]</span> <span class="n">degrees</span> <span class="n">Fahrenheit</span> <span class="c1">#å¾—åˆ°é¢„æµ‹ç»“æœä»ç„¶ä¸å®é™…ç›¸è¿‘</span>
<span class="n">These</span> <span class="n">are</span> <span class="n">the</span> <span class="n">l0</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.52520204</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25983605</span><span class="p">,</span>  <span class="mf">0.27832836</span><span class="p">,</span>  <span class="mf">0.11471745</span><span class="p">]],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">),</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3.468158</span> <span class="p">,</span> <span class="o">-</span><span class="mf">3.3907545</span><span class="p">,</span>  <span class="mf">3.5017395</span><span class="p">,</span>  <span class="mf">2.1893277</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)]</span>
<span class="n">These</span> <span class="n">are</span> <span class="n">the</span> <span class="n">l1</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.37798777</span><span class="p">,</span>  <span class="mf">0.6455525</span> <span class="p">,</span>  <span class="mf">0.7230809</span> <span class="p">,</span>  <span class="mf">0.3954812</span> <span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">0.85110897</span><span class="p">,</span>  <span class="mf">0.6376249</span> <span class="p">,</span>  <span class="mf">0.31107017</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.70929325</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">0.534542</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.980425</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.92369473</span><span class="p">,</span>  <span class="mf">0.72322994</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.38675487</span><span class="p">,</span>  <span class="mf">0.41835558</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24832523</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08700816</span><span class="p">]],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">),</span> <span class="n">array</span><span class="p">([</span> <span class="mf">3.2148993</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.1253922</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.340591</span> <span class="p">,</span>  <span class="mf">3.433869</span> <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)]</span>
<span class="n">These</span> <span class="n">are</span> <span class="n">the</span> <span class="n">l2</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.74975073</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">0.56715256</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">1.4492323</span> <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.39553005</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">),</span> <span class="n">array</span><span class="p">([</span><span class="mf">3.2948794</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)]</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œæ¨¡å‹ä»ç„¶èƒ½å¾ˆå¥½çš„å¾—åˆ°ç»“æœï¼Œä½†å…¶ä¸­çš„å˜é‡æ—©å·²ä¸æ¥è¿‘1.8æˆ–32ï¼Œè¿™æ˜¯å› ä¸ºå¤šå±‚Layerå¸¦æ¥çš„å¤æ‚åº¦éšè—äº†è½¬æ¢æ–¹ç¨‹çš„â€œç®€å•â€å½¢å¼</p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
</article>

     
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "tiiktak" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2019 - 
        
        2021 Tiiktak&#39;s
    </section>
    
    <section class="powerby">
        
            èœ€ICPå¤‡19030250å· <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.3.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-141514532-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-141514532-1');
</script>


<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?0121c6813b611028681cd70e85594cb6";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
    </body>
</html>
